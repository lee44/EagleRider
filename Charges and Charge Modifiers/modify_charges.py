import os
import sys
from os.path import abspath, dirname

import pandas as pd
from playwright.sync_api import sync_playwright

d = dirname(dirname(abspath(__file__)))
sys.path.append(d)
from Utilities.util import Util

util = Util()

charge_id = [
    7794, 7857, 8328, 8329, 8330, 8331, 8332, 8333, 8336, 12464, 14947, 14948, 14949, 14950, 14951, 14952, 14953, 15296, 15297, 15298, 15299, 15300, 15301, 15302, 15303, 15304, 15305, 15306, 15307,
    15308, 15309, 15310, 15311, 15312, 15313, 15314, 15315, 15316, 15317, 15318, 15319, 15320, 15321, 15322, 15323, 15324, 15325, 15326, 15327, 15328, 15329, 15330, 15331, 15332, 15333, 15334, 15335,
    15336, 15337, 15338, 15339, 15340, 15341, 15342, 15343, 15344, 15345, 15346, 15347, 15348, 15349, 15350, 15351, 15352, 15353, 15354, 15355, 15356, 15357, 15358, 15359, 15360, 15361, 15362, 15363,
    15381, 15382, 15383, 15384, 15385, 15386, 15387, 15388, 15389, 15390, 15391, 15392, 15393, 15394, 15395, 15402, 15403, 15404, 15405, 15406, 15407, 15408, 15409, 15410, 15411, 15412, 15413, 15414,
    15415, 15416, 15417, 15418, 15419, 15420, 15421, 15422, 15423, 15429, 15430, 15431, 15432, 15433, 15439, 15440, 15441, 15442, 15443, 15444, 15445, 15446, 15447, 15448, 15462, 15463, 15464, 15465,
    15466, 15467, 15468, 15469, 15470, 15471, 15472, 15473, 15474, 15475, 15476, 15477, 15478, 15479, 15480, 15481, 15482, 15483, 15484, 15485, 15486, 15487, 15488, 15489, 15490, 15491, 15492, 15493,
    15494, 15495, 15496, 15497, 15498, 15499, 15500, 15501, 15502, 15503, 15504, 15505, 15506, 15507, 15508, 15509, 15510, 15511, 15512, 15513, 15514, 15515, 15528, 15529, 15530, 15531, 15532, 15533,
    19156, 19157, 19158, 19159, 19160, 19161, 19162, 19163, 21186, 21187, 21188, 21189, 21190, 21191, 21352, 21353, ]

with sync_playwright() as p:
    browser = p.chromium.launch(headless=False, args=["--window-position=-5,0"])
    context = browser.new_context(
        viewport={
            "width": 2550, "height": 1300}
    )
    page = context.new_page()

    page.goto('https://www.eaglerider.com/activeadmin')

    util.login(page)

    for id in charge_id:
        page.goto(f'https://www.eaglerider.com/activeadmin/charges/{id}/edit')
        page.fill("input[name=\"charge[end_date]\"]", "2022-12-31")
        page.click("input[name=\"commit\"]")

    browser.close()
